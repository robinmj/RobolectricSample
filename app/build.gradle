
apply plugin: 'com.android.application'
apply plugin: 'robolectric'

android {
    compileSdkVersion 20
    buildToolsVersion "20.0.0"

    defaultConfig {
        applicationId "com.pivotallabs"
        minSdkVersion 3
        targetSdkVersion 16
    }

    buildTypes {
        debug {
            debuggable true
        }
        release {
            runProguard false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.txt'
        }
    }
}

// setup robolectric to use only classes that end with "Test"
robolectric {
    include "**/*Test.class"
}

dependencies {
    compile fileTree(dir: "libs", include: ["*.jar"])
    compile "org.roboguice:roboguice:2.0" //some of the non-test classes require roboguice

    // use robolectric when testing
    androidTestCompile("org.robolectric:robolectric:2.3") {
        exclude module: "commons-logging"
        exclude module: "httpclient"
    }
    androidTestCompile "junit:junit:4.11" // use junit 4 for testing

    // add the stripped version of android.jar
    androidTestCompile files("testlibs/android-20-stripped.jar")
}

// tell gradle to include robolectric test classes
task copyTestClasses(type: Copy) {
    from "build/test-classes"
    into "build/intermediates/classes/debug"
}